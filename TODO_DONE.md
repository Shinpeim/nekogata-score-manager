# 完了済みタスク

このファイルには完了したタスクの履歴を記録しています。

## 完了済み

### 2025-06-26: ディグリーネーム表示機能実装
- [x] **ディグリーネーム（度数表記）表示機能** (実施工数: 2.5時間) ✅ 2025-06-26完了
  - **背景**: 音楽理論の学習のため、コードを度数表記（Am → VIm in key of C）で表示したい
  - **技術方針**: ローマ数字表記、品質（m7, dim, sus4等）保持、メジャーキーのみ対応

### 2025-06-26: 文字サイズ調整機能実装
- [x] **コード譜の文字サイズ調整機能** (実施工数: 2.5時間) ✅ 2025-06-26完了
  - **背景**: コード譜の文字が小さすぎるため、ユーザーが文字サイズを調整できるようにしたい
  - **実装内容**: 
    - 楽譜ごとに文字サイズを10px〜24pxの範囲で2pxずつ調整可能
    - ボタンで増減できるUI（数値入力ではなく＋−ボタン）
    - 設定は楽譜ごとに保存される
    - エクスポート・インポートでも設定が保持される

### 2025-06-26: 楽譜一覧のソート機能実装
- [x] **Score Explorerの楽譜一覧のソート機能** (実施工数: 30分) ✅ 2025-06-26完了
  - **背景**: 楽譜一覧の並び順が不定だったため、曲名の昇順で表示したい
  - **実装内容**: MainLayout.tsxで曲名による昇順ソート（日本語対応）を実装
  - **技術詳細**: `localeCompare('ja')`を使用して日本語も正しくソート

### 2025-06-26: コードのコピペ機能削除
- [x] **コードのコピペ機能削除** (実施工数: 1時間) ✅ 2025-06-26完了
  - **背景**: 実際にコード譜を編集しているとほとんど使わない割に実装が複雑だったため削除
  - **削除内容**: 
    - UIコンポーネント: コピー・ペーストボタンの削除（SectionCard.tsx）
    - ロジック: copyChordProgressionToClipboard、pasteChordProgressionFromClipboard関数の削除
    - フック: useSectionOperationsからコピペ関連メソッドとcopiedMessage状態の削除
  - **保持機能**: テキスト一括入力機能（textToChords、isValidChordProgression）は便利なため残存

### 2025-06-28: E2Eテスト品質向上
- [x] **E2Eテスト品質向上** (実施工数: 3時間) ✅ 2025-06-28完了
  - **背景**: ハードコード待機によるテストの不安定性を解消する必要があった
  - **改善内容**:
    - HomePage.ts: CSS遷移待機をMutationObserver/transitionendイベント監視に変更
    - HomePage.ts: ビューポート変更待機をwaitForFunctionで実装
    - ChartViewPage.ts: Score Explorer開閉待機をDOM幅監視に変更
    - ChartViewPage.ts: 編集画面遷移待機をエディタ要素の出現監視に変更
    - app.spec.ts: Score Explorer閉鎖待機をDOM幅監視に変更
  - **技術的制約**: drag-drop.spec.tsのドラッグアニメーション待機（500ms）は@dnd-kitライブラリの制約により残存
  - **結果**: 200テスト中197件成功（改善前より安定性向上）
  - **影響範囲**: 4つのテストファイル修正、全テストパス確認済み

### 2025-07-01: モバイルデバイスでのドラッグ&ドロップ時のスクロール問題修正
- [x] **モバイルデバイスでのドラッグ&ドロップ動作確認** (実施工数: 1時間) ✅ 2025-07-01完了
  - **背景**: モバイルでドラッグ操作時に画面がスクロールしてしまい操作できない問題
  - **実装内容**:
    - TouchSensorを@dnd-kit/coreに追加
    - PointerSensor: 8px移動距離制約（誤タップ防止）
    - TouchSensor: 250ms長押し遅延と5px許容範囲
    - SetListTab、SectionCard、SectionEditorに適用
  - **E2Eテスト対応**:
    - TouchSensor遅延に対応するためドラッグ操作を手動マウスイベントに変更
    - マウスダウン後300ms待機、8px移動後にターゲットへ移動
  - **結果**: 実機でドラッグ&ドロップが正常動作、全E2Eテスト成功

### 2025-07-01: セットリスト画面のドラッグハンドルUI統一
- [x] **セットリスト画面のドラッグハンドルUI統一** (実施工数: 30分) ✅ 2025-07-01完了
  - **背景**: セットリスト一覧とコード譜編集画面でドラッグハンドルの位置・スタイルが不統一
  - **実装内容**:
    - ドラッグハンドルを右側から左側に移動
    - アイコンをテキスト（⋮⋮）から横線2本のSVGアイコンに変更
    - セットリスト用にコンパクトなサイズに調整（w-6、アイコンw-4 h-4）
    - 左パディングを最小化（pl-1）
    - 関連テストを修正
  - **結果**: 両画面で一貫したUI体験を実現